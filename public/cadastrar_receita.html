<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cadastrar Receita</title>
    <link rel="stylesheet" href="../css/receitas.css">
</head>

<body>
  <div class="section">
    <div class="box">
      <span class="titulo">
        <h4>
          Cadastro de receita
        </h4>
      </span>
      <div class="campos">
        <form>
          <input id="ipt_nome" required placeholder="Nome da receita:"/>
        </form>
      </div>
      <div class="campos">
        <form>
          <input id="ipt_tempo" type="text" required placeholder="Tempo de preparo (digite o tempo em minutos):" />
        </form>
      </div>
      <div class="campos_slc">
        <!-- adicionei o select de dificuldade e tambem criei duas div's para eles (alterado 17/01/2025) -->
        <div class="slc">
          <h3 style="text-align: center;">Escolha a categoria desta receita:</h3>
          <form>
            <select id="ipt_categoria">
              <option value="" disabled selected>Categoria</option>
              <option value="Doce">Doce</option>
              <option value="Salgado">Salgado</option>
              <option value="Sobremesa">Sobremesa</option>
              <option value="Entradas">Entradas</option>
              <option value="Lanches">Lanches</option>
              <option value="Sopas">Sopas</option>
              <option value="Salada">Salada</option>
              <option value="Carne">Carne</option>
              <option value="Frango">Frango</option>
              <option value="Fitness">Fitness</option>
            </select>
          </form>
        </div>
        <div class="slc">
          <h3 style="text-align: center;">Escolha a dificuldade para o preparo desta receita:</h3>
          <select>
            <option value="" disabled selected>Dificuldade de preparo</option>
            <option value="Fácil">Fácil</option>
            <option value="Média">Média</option>
            <option value="Difícil">Difícil</option>
          </select>
          </select>
        </div>
      </div>
      <div class="campos">
        <form>
          <input id="ipt_descricao" type="text" required placeholder="Descrição:" />
        </form>
      </div>
      <div class="ingredientes" id="div_ingredientes">
      </div>
      <button onclick="cadastrar_receita()">Cadastrar</button>
    </div>
  </div>
  
  <div class="side">
    <div class="user">
        <div class="line">
            <div class="foto"><img src="../assets/imgs/chef.webp"></div>
            <h3>Olá, Bem vindo</h3>
        </div>
    </div>
    <div class="box-menu">
        <div class="menu">
          <div onclick="dasboard()" style="cursor: pointer;">Dashboard</div>
          <div style="background-color: #E08E37;cursor: pointer;">Cadastrar receitas</div>
        </div>
        <div class="sair">
            <div>
                <h2><a><span onclick="sair()"  style="cursor: pointer;">SAIR</span></a></h2>
            </div>
        </div>
    </div>
  </div>

</body>
</html>

<script>

// criando for para adicionar os 10 campos de ingredientes (alterado 22/01/25)
  var ingredientes = "";
  for(var i = 0; i < 10; i++){
    ingredientes += `
    <div class="ingred-camp">
                  <form>
                    <input id="iptnome_Ingrediente${i+1}" type="text" required placeholder="Ingrediente${i+1}:" />
                    <input id="iptqtd_Ingrediente${i+1}" type="number" required placeholder="Quantidade do Ingrediente${i+1}:" />
                    <select id="slc_Ingrediente${i+1}">
                      <option value="unidade">Unidades</option>
                      <option value="KG">KG</option>
                      <option value="gramas">Gramas</option>
                      <option value="xicaras">Xicaras</option>
                      <option value="Copos">Copos</option>
                      <option value="colheres (chá)">colheres (chá)</option>
                      <option value="colheres (sopa)">colheres (sopa)</option>
                      <option value="ml">ml</option>
                      <option value="litros">litros</option>
                    </select>
                </div>
    `;
  };

  div_ingredientes.innerHTML = ingredientes;
  

function dasboard(){
    window.location.href = './dashboard.html';
}
function receitas(){
    window.location.href = './cadastrar_receitas.html';
}

function sair(){
  sessionStorage.clear();
  window.location.href = './index.html';
}

  function cadastrar_receita() {
    var nomeReceita = ipt_nome.value;
    var tempoReceita = ipt_tempo.value;
    var categoria = ipt_categoria.value;
    var Ingrediente1 = `${iptnome_Ingrediente1.value} ${iptqtd_Ingrediente1.value} ${slc_Ingrediente1.value}`;
    var Ingrediente2 = `${iptnome_Ingrediente2.value} ${iptqtd_Ingrediente2.value} ${slc_Ingrediente2.value}`;
    var Ingrediente3 = `${iptnome_Ingrediente3.value} ${iptqtd_Ingrediente3.value} ${slc_Ingrediente3.value}`;
    var Ingrediente4 = `${iptnome_Ingrediente4.value} ${iptqtd_Ingrediente4.value} ${slc_Ingrediente4.value}`;
    var Ingrediente5 = `${iptnome_Ingrediente5.value} ${iptqtd_Ingrediente5.value} ${slc_Ingrediente5.value}`;
    var Ingrediente6 = `${iptnome_Ingrediente6.value} ${iptqtd_Ingrediente6.value} ${slc_Ingrediente6.value}`;
    var Ingrediente7 = `${iptnome_Ingrediente7.value} ${iptqtd_Ingrediente7.value} ${slc_Ingrediente7.value}`;
    var Ingrediente8 = `${iptnome_Ingrediente8.value} ${iptqtd_Ingrediente8.value} ${slc_Ingrediente8.value}`;
    var Ingrediente9 = `${iptnome_Ingrediente9.value} ${iptqtd_Ingrediente9.value} ${slc_Ingrediente9.value}`;
    var Ingrediente10 = `${ipt_nome_Ingrediente10.value} ${ipt_qtd_Ingrediente10.value} ${slc_Ingrediente10.value}`;
    var descricao = ipt_descricao.value;

    if (
      nomeReceita == "" ||
      tempoReceita == "" ||
      categoria == "" ||
      iptnome_Ingrediente1.value == "" || iptqtd_Ingrediente1.value == "" || slc_Ingrediente1.value == "" ||
      iptnome_Ingrediente2.value == "" || iptqtd_Ingrediente2.value == "" || slc_Ingrediente2.value == "" ||
      iptnome_Ingrediente3.value == "" || iptqtd_Ingrediente3.value == "" || slc_Ingrediente3.value == "" ||
      iptnome_Ingrediente4.value == "" || iptqtd_Ingrediente4.value == "" || slc_Ingrediente4.value == "" ||
      iptnome_Ingrediente5.value == "" || iptqtd_Ingrediente5.value == "" || slc_Ingrediente5.value == "" ||
      ipt_descricao.value == ""
    ) {
      alert("Preencha todos os campos! (numero minimo de 5 ingredientes para cadastrar uma receita)")
      return false;
    }
    
    console.log("Nome: ", nomeReceita )
    console.log("Tempo:  " , tempoReceita)
    console.log("Categor i a: " , categoria)
    console.log("1: " , Ingrediente1) 
    console.log("2: " , Ingrediente2) 
    console.log("3: " , Ingrediente3) 
    console.log("4: " , Ingrediente4) 
    console.log("5: " , Ingrediente5) 
    console.log("6: " , Ingrediente6) 
    console.log("7: " , Ingrediente7) 
    console.log("8: " , Ingrediente8) 
    console.log("9: " , Ingrediente9)
    console.log("10: ", Ingrediente10)




    fetch("/aquarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeReceitaServer : nomeReceita,
        tempoReceitaServer : tempoReceita,
        categoriaServer : categoria,
        Ingrediente1Server : Ingrediente1,
        Ingrediente2Server : Ingrediente2,
        Ingrediente3Server : Ingrediente3,
        Ingrediente4Server : Ingrediente4,
        Ingrediente5Server : Ingrediente5,
        Ingrediente6Server : Ingrediente6,
        Ingrediente7Server : Ingrediente7,
        Ingrediente8Server : Ingrediente8,
        Ingrediente9Server : Ingrediente9,
        Ingrediente10Server : Ingrediente10,
        descricaoServer : descricao,
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta);

        if (resposta.ok) {
          console.log("Cadastro realizado !!")
          // setTimeout(() => {
          //   window.location = "login.html";
          // }, "2000");
        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      }).catch(function (resposta) {
        alert("O cadastro foi mal sucedido devido a um erro com o Banco de dados!")
        console.log(`#ERRO: ${resposta}`);
      });

      alert("Cadastro Realizado com sucesso!")
    return false;
  }
</script>