<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./js/dashboard.js" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="./css/dashboard.css">
    <title>DashBoard</title>
</head>
<body onload="plotarkpi1(), plotarkpi2(), plotarkpi3(), gerarGrafico()">
    <div class="container">
        <div class="dashboard">
            <div class="kpi">
                <!-- editando largura da primeira kpi (alterado 30/01/25) -->
                <!-- alterando cor de fundo das kpi's para branco kpi (alterado 30/01/25) -->
                <div class="box-kpi" id="kpi1" style="width: 35%;">
                    <div class="titulo" style="background-color: #ffffff;">
                        <h2>Categoria mais escolhida pelos usuarios</h2>
                    </div>
                    <div class="kpi-num" id="kpi-categoriaMaisEscolhida" style="background-color: #ffffff;">
                        
                    </div>
                    <div class="kpi-sub-texto" style="background-color: #ffffff;">
                    </div>
                </div>
                <div class="box-kpi" id="kpi2">
                    <div class="titulo" style="background-color: #ffffff;">
                        <h2>Região com mais usuarios</h2>
                    </div>
                    <div class="kpi-num"  id="kpi-regiaoMaisCadastrada" style="background-color: #ffffff;font-size: 25px;">
                        
                    </div>
                    <div class="kpi-sub-texto" style="background-color: #ffffff;">
                    </div>
                </div>
                <div class="box-kpi" id="kpi3">
                    <div class="titulo" style="background-color: #ffffff;">
                        <h2>Total de receitas cadastradas</h2>
                    </div>
                    <div class="kpi-num" id="kpi-QtdReceitas" style="background-color: #ffffff;">
                        
                    </div>
                    <div class="kpi-sub-texto" style="background-color: #ffffff;">
                    </div>
                </div>
            </div>

            <div class="kpi">
                <div class="box-kpi" id="kpi1">
                    <div class="titulo" style="background-color: #ffffff;">
                        <h2>Categoria mais escolhida</h2>
                    </div>
                    <div class="kpi-num" id="kpi-categoriaMaisEscolhida" style="background-color: #ffffff;">
                        
                    </div>
                    <div class="kpi-sub-texto" style="background-color: #ffffff;">
                    </div>
                </div>
                <div class="box-kpi" id="kpi2">
                    <div class="titulo" style="background-color: #ffffff;">
                        <h2>Região com mais cadastros</h2>
                    </div>
                    <div class="kpi-num"  id="kpi-regiaoMaisCadastrada" style="background-color: #ffffff;font-size: 25px;">
                        
                    </div>
                    <div class="kpi-sub-texto" style="background-color: #ffffff;">
                    </div>
                </div>
            </div>

            <div class="grafico">
                <div id="grafico-geral">
                    <h2>Quantidade de receitas por categoria</h2>
                    <canvas id="myChart-grafico" style="width:300px; height: 110px;"></canvas>
                </div>
            </div>
        </div>
        
        <div class="side">
            <div class="user">
                <div class="line">
                    <div class="foto"><img src="../assets/imgs/chef.webp"></div>
                    <h3>Olá, Bem vindo</h3>
                </div>
            </div>
            <div class="box">
                <div class="menu">
                    <div style="background-color: #E08E37;cursor: pointer;">Dashboard</div>
                    <div onclick="receitas()" style="cursor: pointer;">Cadastrar receitas</div>
                    <!-- adicionando botao home (Alterado 30/01/25) -->
                    <div onclick="home()" style="cursor: pointer;">Pagina Inicial</div>
                </div>
                <div class="sair">
                    <div>
                        <h2><a href="./index.html" onclick="logout()"><span>SAIR</span></a></h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<script>
const ctx2 = document.getElementById('myChart-grafico');

var data2 = new Chart(ctx2, {
    type: 'pie', // Alterado de 'bar' para 'pie' para economizar espaço
    data: {
        labels: [
            'Carnes',
            'Bebidas',
            'Congelados',
            'Hortifruti',
            'Limpeza',
        ],
        datasets: [{
            label: 'Fluxo',
            backgroundColor: [
                'rgb(000, 202, 220)',
                'rgb(73, 195, 251)',
                'rgb(101, 166, 250)',
                'rgb(126, 128, 231)',
                'rgb(155, 87, 204)',
            ],
            data: [13451, 11839, 10463, 10338, 8692],
            borderWidth: 2, // Reduzido para deixar o gráfico mais suave
            borderColor: '#fff', // Adicionado borda branca para destacar as fatias
        }]
    },
    options: {
        responsive: true, // Para que o gráfico se ajuste bem em diferentes tamanhos de tela
        plugins: {
            legend: {
                position: 'top', // Posição da legenda
                labels: {
                    font: {
                        size: 14, // Aumentar o tamanho da fonte da legenda
                    },
                    color: '#333', // Cor das legendas
                }
            },
            tooltip: {
                callbacks: {
                    label: function(tooltipItem) {
                        return tooltipItem.label + ': ' + tooltipItem.raw.toLocaleString(); // Exibe números formatados
                    }
                },
            }
        },
    }
});
</script>